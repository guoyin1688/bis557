formula <- iris$Sepal.Length ~ iris
model.matrix(formula, iris)
clear formula
model.matrix(Sepal.Length ~., iris)
mm <- model.matrix(Sepal.Length ~., iris)
class(mm)
y <- iris$Sepal.Length
yy <- iris$Sepal.Length[as.integer(row.names(mm))]
head(y)
head(yy)
yy
y
row.names(mm)
as.integer(row.names(mm))
fit <- linear_model(Sepal.Length ~., iris)
# lm(formula, data)
X <- model.matrix(formula, data)
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data$Sepal.Length
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
}
fit <- linear_model(Sepal.Length ~., iris)
fit
lm(Sepal.Length ~., iris)
fit <- lm(Sepal.Length ~., iris)
class(fit)
fit <- lm(Sepal.Length ~., iris)
ret <- list(fit)
class(ret)
ret
class(fit) <- “lm”
class(fit) <- "lm"
class(ret) <- "lm"
class(ret)
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data$Sepal.Length
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- class(list(betahat))
}
fit <- linear_model(Sepal.Length ~., iris)
class(fit)
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data$Sepal.Length
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list(betahat)
class(flm) <- "lm"
}
fit <- linear_model(Sepal.Length ~., iris)
class(fit)
fit <- linear_model(Sepal.Length ~., iris)
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data$Sepal.Length
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list(betahat)
class(flm) <- "lm"
flm
}
fit <- linear_model(Sepal.Length ~., iris)
class(fit)
fit$coefficient
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data$Sepal.Length
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list()
flm$coefficient <- betahat
class(flm) <- "lm"
return(flm)
}
fit <- linear_model(Sepal.Length ~., iris)
fit$coefficient
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data$Sepal.Length
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list()
flm$terms = terms(x = formula, data = data)
flm$coefficient <- betahat
class(flm) <- "lm"
return(flm)
}
fit <- linear_model(Sepal.Length ~., iris)
fit$coefficient
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- all.vars(formula)[-1]
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list()
flm$coefficient <- betahat
class(flm) <- "lm"
return(flm)
}
fit <- linear_model(Sepal.Length ~., iris)
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data[, all.vars(formula)[-1]]
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list()
flm$coefficient <- betahat
class(flm) <- "lm"
return(flm)
}
fit <- linear_model(Sepal.Length ~., iris)
linear_model <- function(formula, data) {
# lm(formula, data)
X <- model.matrix(formula, data)
y <- data[, all.vars(formula)[1]]
svd_output <- svd(X)
U <- svd_output[["u"]]
Sinv <- diag(1 / svd_output[["d"]])
V <- svd_output[["v"]]
pseudo_inv <- V %*% Sinv %*% t(U)
betahat <- pseudo_inv %*% y
flm <- list()
flm$coefficient <- betahat
class(flm) <- "lm"
return(flm)
}
fit <- linear_model(Sepal.Length ~., iris)
fit$coefficient
