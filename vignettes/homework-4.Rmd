---
title: "Homework 4"
author: "Clint Guo"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
  html_document:
    self_contained: yes
    toc: yes
---
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Homework 3 vignette}
-->

**1.** CASL page 143, question 2

We can generate a very simple example where the linear Hessian ($X^tX$) is well-conditioned but its logistic variation is not (with the generation of corresponding $\beta$ and $p$). 

Let's see a toy linear model example with $n=p=2$. We set $X$ as

$$
X=\left(\begin{array}{cc}
2 & 0 \\
0 & 1
\end{array}\right)
$$

The linear Hessian ($X^tX$) is very easy to computed given $X$ is a diagnal matrix. 

$$
H_1=X^tX=\left(\begin{array}{cc}
4 & 0 \\
0 & 1
\end{array}\right)
$$

The condition number of a matrix is the ratio of its largest and smallest singular value. 
$$cond(H_1)=\frac{\sqrt{4}}{\sqrt{1}}=2$$

While the Hessian is well-conditioned, we set $\beta=(0, -100)^t$ such that 

$$y=X*\beta=\left(\begin{array}{cc}
0 \\
-100
\end{array}\right)$$

$$p_1=\frac{e^0}{1+e^0}=0.5$$

$$p_2=\frac{e^{-100}}{1+e^{-100}}=3.7*10^{-44}$$

We set $p_1=0.5$ is due to the fact that the expression $p(1-p)$ reaches its maximum $0.25$ at $p=0.5$. 

The logistic Hessian is computed as follow. 

$$
\begin{aligned}
H_2&=X^t*diag(p*(1-p))*X \\
&=\left(\begin{array}{cc}
2 & 0 \\
0 & 1
\end{array}\right)*\left(\begin{array}{cc}
0.5*(1-0.5) & 0 \\
0 & 3.7*10^{-44}*(1-3.7*10^{-44})
\end{array}\right)*\left(\begin{array}{cc}
2 & 0 \\
0 & 1
\end{array}\right) \\
&=\left(\begin{array}{cc}
1 & 0 \\
0 & 3.7*10^{-44}
\end{array}\right)
\end{aligned}
$$

The condition number is then computed. 

$$cond(H_2)=\frac{\sqrt{1}}{\sqrt{3.7*10^{-44}}}=5.2*10^{21}$$

The logistic Hessian is then ill-conditioned. 

